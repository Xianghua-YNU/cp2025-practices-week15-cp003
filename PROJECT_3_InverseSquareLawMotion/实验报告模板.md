# 项目：平方反比引力场中的运动 - 实验报告

**学生姓名：** [Yuan Xuanjun]
**学号：** [20231050123]
**完成日期：** [2025/6/4]

## 1. 实验目的

通过数值模拟研究不同能量和角动量条件下质点在平方反比引力场中的轨道特性，验证能量守恒和角动量守恒定律，并分析轨道形状与能量、角动量的关系。

## 2. 核心算法与实现

### 2.1 运动方程与数值方法
使用直角坐标系下的二阶微分方程组描述运动：
'''
dx/dt = vx
dy/dt = vy
dvx/dt = -GM * x / r³
dvy/dt = -GM * y / r³
'''
其中 r = √(x² + y²)。采用scipy.integrate.solve_ivp进行数值求解，方法为RK45，相对容差rtol=1e-7，绝对容差atol=1e-9。
### 2.2 关键函数实现思路
 `derivatives` 或 `solve_orbit`

#### `[derivatives]` 实现思路：
从状态向量解包出位置和速度分量
计算距离r并处理接近零的特殊情况
计算引力加速度分量
返回导数向量[vx, vy, ax, ay]
```python
def derivatives(t, state_vector, gm_val):
    x, y, vx, vy = state_vector
    r = np.sqrt(x**2 + y**2)
    r_cubed = r**3 if r > 1e-10 else 1e-30
    ax = -gm_val * x / r_cubed
    ay = -gm_val * y / r_cubed
    return [vx, vy, ax, ay]
```

#### `[solve_orbit]` 实现思路：
调用solve_ivp函数
设置积分时间区间和评估点
传递derivatives函数和GM参数
返回解对象
```python
def solve_orbit(initial_conditions, t_span, t_eval, gm_val):
    return solve_ivp(fun=derivatives, t_span=t_span, y0=initial_conditions,
                   t_eval=t_eval, args=(gm_val,), method='RK45',
                   rtol=1e-7, atol=1e-9)
```

## 3. 实验结果与分析

### 3.1 不同总能量下的轨道


**图1：不同能量下的轨道图 (E<0, E=0, E>0)**
![image](https://github.com/user-attachments/assets/2073ac96-18fb-4fba-9768-f0b2126662b8)
图像显示三种能量条件下的轨道：
椭圆轨道 (E = -0.68): 闭合轨道，中心天体位于一个焦点
抛物线轨道 (E ≈ 0): 开放轨道，逃逸速度刚好为零
双曲线轨道 (E = 0.44): 开放轨道，逃逸速度为正
**结果分析：**
E<0时系统处于束缚状态，形成闭合椭圆轨道
E=0为临界状态，轨道为抛物线
E>0时系统非束缚，轨道为双曲线


### 3.2 不同角动量下的椭圆轨道 (E < 0)

**图2：固定能量 (E=-0.500)，不同角动量下的椭圆轨道**
![image](https://github.com/user-attachments/assets/37485021-18f7-45d4-8b7a-0753eab744c0)

轨道参数：
L=0.500: 高偏心率椭圆 
L=0.700: 中等偏心率椭圆
L=0.900: 近圆形轨道 


**结果分析：**
角动量增大导致：
轨道偏心率减小
近地点距离增大
轨道更接近圆形

## 4. 问题与收获

### 4.1遇到的主要问题及解决方法

**问题1：** 初始条件设置不当导致轨道计算发散
**解决方法：** 通过能量公式反推合适的初始速度，确保物理合理性

**问题2：** r接近零时的数值不稳定
**解决方法：** 设置最小r阈值(1e-10)避免除以零错误

### 4.2 主要收获与体会
深入理解了轨道力学中能量与角动量的关键作用
掌握了ODE数值求解的实际应用技巧
学会了通过物理定律验证数值结果的正确性
提升了科学计算可视化能力

## 5. (可选) 思考与展望


### 5.1 坐标转换与对称性
未考虑相对论效应
假设中心天体固定不变
未计入其他摄动力（如辐射压、潮汐力）
### 5.2 其他思考
引入自适应步长控制提高计算效率
扩展为三维空间运动
加入多体相互作用
开发交互式轨道参数调节界面

